import{t as d,x as O,y as P,z as C,u as E,a as F,b as i,au as k,c as N,d as Q,av as D,e as T,m as v,aw as z,ax as R,ay as w,az as G,aA as L,aB as q,aC as M,aD as U,aE as H,aF as J,aG as K,aH as V,aI as W,aJ as X,aK as Y,aL as Z,j as t,G as l,E as _,aM as $,aN as b,r as ee,S as te,aO as se,aP as ae,aQ as ne,aR as oe,l as ce,aS as re,aT as ie,k as de,D as ue,aU as le,aV as ye}from"./index-BcZMUM3W.js";function me(n){const[a]=d.dcaBot.getOne.useSuspenseQuery(n),[s]=d.exchangeAccount.getOne.useSuspenseQuery(a.exchangeAccountId),o=O(s.exchangeCode,C(a.symbol),P(a.symbol)),[c]=d.symbol.getOne.useSuspenseQuery({symbolId:o}),[{price:u}]=d.symbol.price.useSuspenseQuery({symbolId:c.symbolId});return{bot:a,exchangeAccount:s,symbol:c,currentAssetPrice:u}}function ge(){const{showSnackbar:n}=E(),a=F(),s=i(k),{mutate:o,isLoading:c}=d.dcaBot.update.useMutation({onSuccess(e){n("Bot created successfully"),setTimeout(()=>{a({to:N("dca-bot/:id",e.id)})},1e3)}});return{isLoading:c,handleSubmit:()=>{const e=he(s);o(e)}}}function he(n){const{entryOrderType:a,entryOrderQuantity:s,entryConditions:o,takeProfitPercent:c,safetyOrders:u,symbolId:e,exchangeAccountId:g,botName:y}=n,{currencyPairSymbol:m}=Q(e);return{botId:n.botId,data:{name:y,settings:{entry:{type:a,quantity:Number(s),conditions:o},tp:{percent:c},safetyOrders:u},symbol:m,exchangeAccountId:g}}}function xe(){const{id:n}=D.useParams(),a=Number(n),{bot:s,exchangeAccount:o,symbol:c,currentAssetPrice:u}=me(a),e=T();v()&&(e(z(s.id)),e(R(o.id)),e(w(o.exchangeCode)),e(G(c.symbolId)),e(L(s.name)),e(q(s.settings.entry.quantity.toString())),e(M(s.settings.entry.type)),e(U(s.settings.entry.conditions)),e(H(s.settings.tp.percent)),e(J(s.settings.safetyOrders)));const y=i(K),[m]=d.exchangeAccount.getOne.useSuspenseQuery(y),h=i(V),[x]=d.symbol.getOne.useSuspenseQuery({symbolId:h}),S=i(W),p=i(X),f=r=>e(ye(r)),I=i(Y),B=i(Z),{handleSubmit:j,isLoading:A}=ge();return t.jsx(l,{container:!0,spacing:2,children:t.jsxs(_,{children:[t.jsx(l,{md:9,children:t.jsx($,{barSize:p,currentAssetPrice:u,safetyOrders:I,takeProfitPercent:B,onBarSizeChange:f,symbolId:h})}),t.jsxs(l,{md:3,children:[t.jsx(b,{level:"h2",sx:{mb:1},children:"Bot settings"}),t.jsx(ee.Suspense,{fallback:t.jsx(te,{animation:"wave",height:300,sx:{borderRadius:8},variant:"rectangular",width:"100%"}),children:t.jsx(se,{hideTimeframe:!0,defaultBot:s,isLoading:A,onSubmit:j,botName:S,onBotNameChange:r=>e(ae(r)),exchangeAccount:m,onExchangeAccountChange:({id:r})=>e(ne(r)),symbol:x,onSymbolChange:({symbolId:r})=>e(oe(r))})})]}),t.jsx(l,{md:9,children:t.jsxs(ce,{display:"flex",flexDirection:"column",gap:2,children:[t.jsx(re,{}),t.jsx(ie,{}),t.jsxs(de,{children:[t.jsx(b,{level:"title-lg",children:"Safety orders"}),t.jsx(ue,{}),t.jsx(le,{})]})]})}),t.jsx(l,{md:3})]})})}export{xe as default};
